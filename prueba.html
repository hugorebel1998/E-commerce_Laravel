<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.18/vue.min.js"></script> -->
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>


<!-- <div class="container mt-5">


    <div class="card card-info" id="app">
        <div class="card-header">
            <div class="card-tools">
                <button type="button" class="btn btn-tool" data-card-widget="collapse">
                    <i class="fas fa-minus"></i>
                </button>
            </div>
        </div>
        <div class="card-body">
            <h5 class="text-left mb-4"> <i class="far fa-credit-card"></i> Sección de precios</h5>
            <div class="row">
                <div class="col-md-6">
                    <label for="precio_anterior">Precio anterior</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">$</span>
                        </div>
                        <input type="number" name="precio_anterior" min="0" step=".01" class="form-control"
                            placeholder="Precio anterior" v-model="precio_anterior">
                    </div>

                </div>
                <div class="col-md-6">
                    <label for="precio_actual">Precio actual</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">$</span>
                        </div>
                        <input type="number" name="precio_actual" min="0" step=".01" class="form-control"
                            placeholder="Precio actual" v-model="precio_actual">
                    </div>

                    <br>
                    <span id="descuento">
                        {{ generardescuento }}
                    </span>
                </div>
                <div class="col-md-12 mt-6">
                    <label for="category_id">Porcentaje de descuento</label>
                    <div class="input-group">
                        <input class="form-control" type="number" id="porcentaje_descuento" name="porcentaje_descuento"
                            step="any" min="1" max="100" value="0" v-model="porcentaje_descuento">
                        <div class="input-group-prepend">
                            <span class="input-group-text">%</span>
                        </div>
                    </div>
                    <div class="progress mt-3 mb-4">
                        <div class="progress-bar" role="progressbar" v-bind:style="{width:porcentaje_descuento+'%'}"
                            aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">{{ porcentaje_descuento }}%</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div> -->
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card card-info" id="app">
                <div class="card-header">
                    <div class="card-tittle">Crear categoria</div>
                </div>
                <div class="card-body">
                    <form action="#" method="post">

                        <div class="row">
                            <div class="col-md-6">
                                <label for="nombre">Nombre de categoria</label>
                                <input type="text" name="nombre" class="form-control" id="nombre"
                                    placeholder="Nombre de categoria" v-model="nombre" @blur="getCaregory" @focus="div_aparecer=false">
                            </div>
                            <div class="col-md-6">
                                <label for="slug">Slug</label>
                                <input type="text" name="slug" id="slug" class="form-control" readonly
                                    v-model="generarSlug" placeholder="Nombre de categoria">
                                <div v-if="div_aparecer" v-bind:class="div_clase_slug">
                                    {{ div_mensajeslug }}
                                </div>
                            </div>

                            <div class="col-md-12 mt-4">
                                <label for="descripcion">Decripción</label>
                                <textarea name="descripcion" id="descripcion" class="form-control" rows="3"></textarea>


                            </div>
                        </div>
                        <div class="text-center mt-4">
                            <button :disabled="deshabilitar_boton==1" type="submit" class="btn btn-sm btn-primary"> <i class="fas fa-save"></i>
                                Guardar</button>
                        </div>
                    </form>
                </div>
                {{ nombre }}
                <br>
                {{ slug}}
                <br>
            </div>
        </div>
    </div>
</div>

<script>
    var app = new Vue({
        el: '#app',
        data: {
            nombre: 'Hugo Guillermo',
            slug: ' ',
            div_mensajeslug: 'Slug existente',
            div_clase_slug: 'badge badge-danger mt-2',
            div_aparecer: false,
            deshabilitar_boton: 0
        },
        computed: {
            generarSlug: function () {
                var char = {
                    "á": "a", "é": "e", "í": "i", "ó": "o", "ú": "u",
                    "Á": "A", "É": "E", "Í": "I", "Ó": "O", "Ú": "U",
                    "ñ": "n", "Ñ": "N", " ": "-", "_": "-"
                }
                var expr = /[áéíóúÁÉÍÓÚÑñ_ ]/g;
                this.slug = this.nombre.trim().replace(expr, function (e) {
                    return char[e]
                }).toLowerCase()
                return this.slug;
                // return this.nombre.trim().replace(/ /g,'-').toLowerCase();
            }
        },
        methods: {
            getCaregory() {
                let url = '/categoria/show/' + this.slug;
                axios.get(url).then(response => {
                    this.div_mensajeslug = response.data;
                    if (this.div_mensajeslug === 'Slug disponible') {
                        this.div_clase_slug = "badgebadge-success";
                        this.deshabilitar_boton = 0;

                    } else {
                        this.div_clase_slug = "badgebadge-danger";
                        this.deshabilitar_boton = 1;
                    }
                    this.div_aparecer = true;

                })
            }
        }
    });

</script>

<!-- <script>
    var app = new Vue({
        el: '#app',
        data: {
            precio_anterior: 0,
            precio_actual: 0,
            descuento: 0,
            porcentaje_descuento: 0,
            descuento_mensaje: '0',

        },
        computed: {
            generardescuento: function () {

                if (this.porcentaje_descuento > 100) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'No puedes ingresar un valor mayor a 100',    
                    });
                    
                    this.porcentaje_descuento = 100;
                    this.descuento = (this.precio_anterior * this.porcentaje_descuento) / 100;
                    this.precio_actual = this.precio_anterior - this.descuento;
                    this.descuento_mensaje = "Este producto tiene el 100% de descuento, por ende este producto es gratis.";
                    return this.descuento_mensaje;

                } else
                    if (this.porcentaje_descuento < 0) {
                        Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'No puedes ingresar un valor menor que 0',    
                    });
                        
                        this.porcentaje_descuento = 0;
                        this.descuento = (this.precio_anterior * this.porcentaje_descuento) / 100;
                        this.precio_actual = this.precio_anterior - this.descuento;
                        this.descuento_mensaje = "";
                        return this.descuento_mensaje;

                    } else

                        if (this.porcentaje_descuento > 0) {
                            this.descuento = (this.precio_anterior * this.porcentaje_descuento) / 100;
                            this.precio_actual = this.precio_anterior - this.descuento;


                            if (this.porcentaje_descuento == 100) {
                                this.descuento_mensaje = "Este producto tiene el 100% de descuento, por ende este producto es gratis.";

                            } else {
                                this.descuento_mensaje = 'Descuento de $MX:' + this.descuento;
                            }
                            return this.descuento_mensaje;
                        } else {
                            this.descuento = "";
                            this.precio_actual = this.precio_anterior;
                            this.descuento_mensaje = " ";
                            return this.descuento_mensaje;
                        }


            }
        },

    });
</script> -->

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
    crossorigin="anonymous"></script>